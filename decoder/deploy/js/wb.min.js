var Bundle=function(e){var n=window.URL||window.webkitURL;null==n&&(n={createObjectURL:function(){return""}});var r=this;r.data={},r.url="",r.buffer=null,r.storeBuffer=null==e?!1:e,r.g=null,r.entries=[],r.parsePixels=function(e,n,t){return r.g=null==r.g?document.createElement("canvas").getContext("2d"):r.g,r.g.imageSmoothingEnabled=!1,r.parseImg(e,function(e){var t=e.width,a=e.height;r.g.canvas.width=t,r.g.canvas.height=a,r.g.drawImage(e,0,0);var l=r.g.getImageData(0,0,t,a),o=l.data,u=o.length/(t*a);null!=n&&n(o,t,a,u)},t)},r.parseImg=function(e,n,t){var a=null==t?"application/octet-stream":t,l=new Image;return l.onload=function(){null!=n&&n(l)},l.onerror=function(){console.error("bundle> failed to parse <img>")},l.src=r.parseURI(e,a),l},r.parseURI=function(e,r){var t=null==r?new Blob([e]):new Blob([e],{type:r});return n.createObjectURL(t)},r.parse=function(e,n){r.parsePixels(e,function(e,t,a){var l=0,o="",u=t*a,i=new Uint8Array(3*u);r.storeBuffer&&(r.buffer=i);for(var s=0;s<e.length;s++)(s+1)%4!=0&&(i[l++]=e[s]);for(l=0;l<i.length;){if(i[l]<5){l++;break}o+=String.fromCharCode(i[l++])}r.entries=[];var d=o.split("\n");o=d.join(""),d=o.split(";");for(var s=0;s<d.length;s++)if(""!=d[s]){var f=d[s].split(","),c={};c.path=f[0],c.type=f[1],c.length=parseInt(f[2]),r.entries.push(c)}for(var g=r.entries,s=0;s<g.length;s++){var c=g[s],p=i.subarray(l,l+c.length);l+=c.length,r.data[c.path]=p}null!=n&&n(r)})},r.load=function(e,n){r.url=e;var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="arraybuffer",t.onprogress=function(e){var r=(e.loaded,e.total,.999*(e.total<=0?0:e.loaded/(e.total+5)));null!=n&&n(null,r)},t.onload=function(){r.parse(t.response,function(e){null!=n&&n(e,1)})},t.send()},r.exists=function(e){return null!=r.data[e]},r.read=function(e){return null==r.data[e]&&console.error("bundle> ["+e+"] not found."),r.data[e]},r.readText=function(e){var n=r.read(e);if(null==n)return t;for(var t="",a=0;a<n.length;a++)t+=String.fromCharCode(n[a]);return t},r.readJSON=function(e){var n=r.readText(e);return""==n?{}:JSON.parse(n)},r.readElement=function(e,n){var t=document.createElement(n);return t.textContent=r.readText(e),t},r.readScript=function(e){return r.readElement(e,"script")},r.readCSS=function(e){return r.readElement(e,"style")},r.readImg=function(e,n){return r.parseImg(r.read(e),n)},r.readDataURL=function(e,n){var t=r.read(e);return null==t?"":r.parseURI(t,n)},r.readRGBA=function(e,n,t){r.parsePixels(r.read(e),n,t)}};