var Bundle=function(e){var n=window.URL||window.webkitURL;null==n&&(n={createObjectURL:function(){return""}});var r=this;r.data={},r.url="",r.buffer=null,r.storeBuffer=null==e?!1:e,r.g=null,r.entries=[],r.parsePixels=function(e,n,t){return r.g=null==r.g?document.createElement("canvas").getContext("2d"):r.g,r.g.imageSmoothingEnabled=!1,r.parseImg(e,function(e){var t=e.width,a=e.height;r.g.canvas.width=t,r.g.canvas.height=a,r.g.drawImage(e,0,0);var l=r.g.getImageData(0,0,t,a),o=l.data,u=o.length/(t*a);null!=n&&n(o,t,a,u)},t)},r.parseImg=function(e,n,t){var a=null==t?"application/octet-stream":t,l=new Image;return l.onload=function(){null!=n&&n(l)},l.onerror=function(){console.error("bundle> failed to parse <img>")},l.src=r.parseURI(e,a),l},r.parseURI=function(e,r){var t=null==r?new Blob([e]):new Blob([e],{type:r});return n.createObjectURL(t)},r.parse=function(e,n,t){r.parsePixels(e,function(e,a,l){var o=0,u="",i=a*l,d=new Uint8Array(3*i),s=null==t?"":t;r.storeBuffer&&(r.buffer=d);for(var f=0;f<e.length;f++)(f+1)%4!=0&&(d[o++]=e[f]);for(o=0;o<d.length&&!(d[o]<5);)u+=String.fromCharCode(d[o++]);o++;var c=0;if(""!=s)for(var g=o;g<d.length;g++){var p=d[g],v=s.charCodeAt(c);p=v^p,d[g]=p,c=(c+1)%s.length}r.entries=[];var h=u.split("\n");u=h.join(""),h=u.split(";");for(var f=0;f<h.length;f++)if(""!=h[f]){var m=h[f].split(","),w={};w.path=m[0],w.type=m[1],w.length=parseInt(m[2]),r.entries.push(w)}for(var b=r.entries,f=0;f<b.length;f++){var w=b[f],I=d.subarray(o,o+w.length);o+=w.length,r.data[w.path]=I}null!=n&&n(r)})},r.load=function(e,n,t){r.url=e;var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onprogress=function(e){var r=(e.loaded,e.total,.999*(e.total<=0?0:e.loaded/(e.total+5)));null!=n&&n(null,r)},a.onload=function(){r.parse(a.response,function(e){null!=n&&n(e,1)},t)},a.send()},r.exists=function(e){return null!=r.data[e]},r.read=function(e){return null==r.data[e]&&console.error("bundle> ["+e+"] not found."),r.data[e]},r.readText=function(e){var n=r.read(e);if(null==n)return t;for(var t="",a=0;a<n.length;a++)t+=String.fromCharCode(n[a]);return t},r.readJSON=function(e){var n=r.readText(e);return""==n?{}:JSON.parse(n)},r.readElement=function(e,n){var t=document.createElement(n);return t.textContent=r.readText(e),t},r.readScript=function(e){return r.readElement(e,"script")},r.readCSS=function(e){return r.readElement(e,"style")},r.readImg=function(e,n){return r.parseImg(r.read(e),n)},r.readDataURL=function(e,n){var t=r.read(e);return null==t?"":r.parseURI(t,n)},r.readRGBA=function(e,n,t){r.parsePixels(r.read(e),n,t)}};